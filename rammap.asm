10 ORG 100H
20 JP MAIN
30START: DB 0,070H
40L0: DB 255
50L1: DB 16
60WRASR EQU 0BFAFH
70PUTSTR EQU 0BFF1H
80INKEY EQU 089BEH
90PUTCHR EQU 0BE62H
100INITSR EQU 0871AH
110AOUT EQU 0BD09H
120OPENSR EQU 0BCE8H
130CLOSSR EQU 0BCEBH
140LRDSR EQU 0BD15H
150WAITK EQU 0BFCDH
160WCHRSR EQU 0BFAFH
170WSTSR EQU 0BFB2H
180A2HEX EQU 0F9BDH
190RPTCHR EQU 0BFEEH
200HLOUT EQU 0BD0FH

300MAIN: CALL INITSR
310 CALL OPENSR
320 LD HL,L0
330 LD A,255
340 LD (HL),A
350 LD HL,L1
360 LD A,16
370 LD (HL),A
380 CALL CLS
390 LD HL,GREET
400 LD B,6
410 LD DE,0
420 CALL PUTSTR
430 LD HL,GREET
440 CALL WSTSR
450 LD HL,BUFFER
460 PUSH HL
470MAIN1: LD HL,(START)
480 LD A,(HL)
490 INC HL
500 LD (START),HL
510 POP HL
520 CALL BYTE
530 LD (HL),32
540 INC HL
550 PUSH HL
560 LD A,(L1)
570 DEC A
580 LD (L1),A
590 CP 0
600 JP NZ,MAIN1
610 LD B,49
620 POP HL
630 LD HL,BUFFER
640 PUSH HL
650 CALL PUTSTR
660 LD DE,0
670 LD HL,BUFFER
680 CALL WSTSR
690 LD A,16
700 LD (L1),A
710 LD A,(L0)
720 DEC A
730 LD (L0),A
740 CP 0
750 JP NZ,MAIN1
760 CALL CLOSSR
770 POP HL
780 RET

1000CLS: LD B,144
1010 LD DE,0
1020CLS0: LD A,32
1030 CALL RPTCHR
1040 RET
1050BYTE: PUSH AF
1060 AND 0F0H
1070 RRCA
1080 RRCA
1090 RRCA
1100 RRCA
1110 CALL NIBBLE
1120 INC HL
1130 POP AF
1140 AND 15
1150 CALL NIBBLE
1160 INC HL
1170 RET
1180NIBBLE: SUB 10
1190 JP M,ZERO9
1200 ADD A,7
1210ZERO9: ADD A,58
1220 LD (HL),A

5000BUFFER: DEFS 48
5010 DB 13,10,0,0
5020GREET: DB 'Hello',13,10,0


