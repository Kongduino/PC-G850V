10 CLS
20 MX=144:MY=48
30 FOR Y=0 TO (MY-1)
40 FOR X=0 TO (MX-1)
50 GOSUB "SHADER"
60 IF (RGB=1) THEN PSET (X,Y)
70 NEXT X
80 NEXT Y
90*WAITK: R$=INKEYS
100 IF R$="" THEN "WAITK"
110 END
120*SHADER: RGB=0
130 XF=(X/MX-0.5)*0.9
140 X2=XF*XF: Z2=Z*Z
150 YF=((Y/MY-0.5)*MY/MX)*0.9
160 Y2=YF*YF
170 VL= SQR(X2+Y2+Z2)
180 VL= SQR(X2+Y2+Z2)
190 VX=XF/VL: VY=YF/VL: VZ=-1/VL
200 P=0
210 FOR I=0 TO 40
220 PX=P*VX: PY=P*VY: PZ=5+P*VZ
230 TY=PY: TZ=PZ
240 PY=(3*TY+4*TZ)*0.1: PZ=(-4*TY+3*TZ)*0.1
250 D=PY+SIN(SQR(PX*PX+PZ*PZ)*6.0-4.5)*0.15+1.5
260 IF (D<0.01) THEN GOTO "OK"
270 IF (P>10) THEN RETURN
280 P=P+D
290 NEXT I
300*OK: A= INT(PX*4)+ INT(PZ*4)
310 RGB=A- INT(A/2)*2
320 RETURN



