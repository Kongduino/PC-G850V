10 A=&H100
20 DT=-1: I=-1
22 DIM AZ(5)
30*MAIN: B= PEEK (A)
40 E$= RIGHT$ ("000"+ HEX$ (A), 4)
50 A=A+1

53 IF I=-1 THEN
55 IF DT>-1 AND A>=DT THEN
56 GOTO "UNKNOWN"
57 ENDIF
59 ENDIF

60 IF B=&HC3 OR B=&HCD THEN
70 GOSUB "CALCADR"
80 D$= RIGHT$ ("000"+ HEX$ (C), 4)
90 Z$=""

100 IF B=&HC3 THEN
110 Z$=Z$+"JP "
120 ELSE
130 Z$=Z$+"CALL "
140 ENDIF
145 GOSUB "FUNCNAME"
147 IF FN$="" THEN
149 PRINT E$+": "+Z$+"0x"+ D$
151 ELSE
153 PRINT E$+": "+Z$+" "+FN$
155 ENDIF

160 A=A+2
170 GOTO "LOOP"
180 ENDIF

190 IF B = 1 OR B=&H11 OR B= &H21 OR B= &H31 THEN
200 GOSUB "CALCADR"
210 D$= RIGHT$ ("000"+ HEX$ (C), 4)
220 H=INT(B/16)
230 PRINT E$+": LD "+MID$("BCDEHLSP", H*2+1, 2)+", 0x"+ D$
240 A=A+2
241 IF BC=&H21 THEN
242 REM LD HL
243 IF DT = -1 THEN
244 DT = C
245 ELSE
246 IF C<DT THEN
247 DT = C
248 ENDIF
249 ENDIF
250 ENDIF
255 GOTO "LOOP"
260 ENDIF

270 IF B = 6 OR B=14 OR B= &H16 OR B= &H1E OR B= &H26 OR B= &H2E OR B= &H3E THEN
200 GOSUB "CALCADR"
210 D$=RIGHT$("0"+ HEX$(PEEK(A)), 2)
220 H=INT(B/8)
230 PRINT E$+": LD "+MID$("BCDEHL A", H+1, 1)+", 0x"+ D$
240 A=A+1
250 GOTO "LOOP"
260 ENDIF

270 IF B = &HC9 THEN
280 PRINT E$+": RET"
290 GOTO "LOOP"
300 ENDIF

310 IF B = &HED AND PEEK(A) = &H4D THEN
320 PRINT E$+": RETI"
330 A=A+1
340 GOTO "LOOP"
350 ENDIF

360 IF B = &HED AND PEEK(A) = &H45 THEN
370 PRINT E$+": RETN"
380 A=A+1
390 GOTO "LOOP"
400 ENDIF

410 IF B = &HE6 THEN
412 B=PEEK(A): A=A+1
414 D$=RIGHT$("0"+ HEX$(B), 2)
416 PRINT E$+": AND 0x"+ D$
418 ENDIF

420 IF B = &HDD AND PEEK(A) = &HA6 THEN
422 PRINT E$+": AND (IX+"+STR$(PEEK(A+1))+")"
424 A=A+2
426 GOTO "LOOP"
428 ENDIF

430 IF B = &HA6 THEN
432 PRINT E$+": AND (HL)"
434 A=A+1
436 GOTO "LOOP"
438 ENDIF

440 IF B = &HFD AND PEEK(A) = &HA6 THEN
442 PRINT E$+": AND (IY+"+STR$(PEEK(A+1))+")"
444 A=A+2
446 GOTO "LOOP"
448 ENDIF



600*UNKNOWN: D$=RIGHT$("0"+ HEX$(B), 2)
610 IF B<32 OR B>127 THEN
620 PRINT E$+": 0x"+ D$+ " [.]"
630 ELSE
640 PRINT E$+": 0x"+ D$+ " "+CHR$(B)
650 ENDIF

900*LOOP: D$= INKEY$
910 IF D$="" THEN
912 GOTO "LOOP"
914 ENDIF

920 IF D$="G" AND I<5 THEN
928 I=I+1
930 AZ(I)=A
932 A=C
934 ENDIF

940 IF D$="R" AND I>-1 THEN
942 A=AZ(I)
944 I=I-1
946 ENDIF

990 GOTO "MAIN"

1000*CALCADR: C=PEEK (A+1)*256
1010 C=C+PEEK (A)
1020 RETURN

2000*FUNCNAME
2005 IF C = &H84F7 THEN
2010 FN$="SCROLUP"
2020 RETURN
2030 ENDIF
2040 IF C = &H871A THEN
2050 FN$="INIT11P"
2060 RETURN
2070 ENDIF
2080 IF C = &HBCBE THEN
2090 FN$="STAT"
2100 RETURN
2110 ENDIF
2120 IF C = &HBCDF THEN
2090 FN$="RASRB2A"
2100 RETURN
2110 ENDIF
2120 IF C = &HBEC2 THEN
2130 FN$="RWSRB2A"
2140 RETURN
2150 ENDIF
2160 IF C = &HBEC2 THEN
2170 FN$="RASWB2A"
2180 RETURN
2190 ENDIF
2200 IF C = &HBCE8 THEN
2210 FN$="OPEN11P"
2220 RETURN
2230 ENDIF
2240 IF C = &HBCEB THEN
2250 FN$="CLOS11P"
2260 RETURN
2270 ENDIF
2280 IF C = &HBD03 THEN
2290 FN$="REGOUT"
2300 RETURN
2310 ENDIF
2320 IF C = &HBE65 THEN
2330 FN$="INSLN"
2340 RETURN
2350 ENDIF
2360 IF C = &HBFF1 THEN
2370 FN$="DSPDE"
2380 RETURN
2390 ENDIF
2360 IF C = &HBD15 THEN
2370 FN$="LNRD11P"
2380 RETURN
2390 ENDIF
3998 FN$=""
3999 RETURN
