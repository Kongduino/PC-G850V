10 ORG 0100H
20 JP START
30ADR0 EQU 8000H
40ADR1 EQU 8001H
50ROMB0: db 0 ;before trying to write to 0x8000
60ROMB1: db 0
70ROMA0: db 0 ;after writing
80ROMA1: db 0
90RAMB0: db 0 ;before writing to ext. mem
100RAMB1: db 0
110RAMA0: db 0 ;after writing to ext. mem
120RAMA1: db 0
130 ;
140START: LD A, (ADR0)
150 LD (ROMB0), A
160 INC A
170 LD (ADR0), A
180 LD A, (ADR0)
190 LD (ADR0), A
200 LD (ROMA0), A

210 LD A, (ADR1)
220 LD (ROMB1), A
230 INC A
240 LD (ADR1), A
250 LD A, (ADR1)
260 LD (ADR1), A
270 LD (ROMA1), A
280 ; enable ext. ram to 0x8000-0xC0000
290 DI
300 IN A,(17H)
310 PUSH AF
320 LD A,0
330 OUT (17H),A ; disable periph. interrupts
340 IN A, (19H)
350 PUSH AF
360 LD B, 50H  ; /CEROM2=L,  BANK1=0, BANK0=1
370 OR B
380 OUT (19H),A
390 ;
400 LD A, (ADR0)
410 LD (RAMB0), A
420 INC A
430 LD (ADR0), A
440 LD A, (ADR0)
450 LD (ADR0), A
460 LD (RAMA0), A

470 LD A, (ADR1)
480 LD (RAMB1), A
490 INC A
500 LD (ADR1), A
510 LD A, (ADR1)
520 LD (ADR1), A
530 LD (RAMA1), A
540 ;reenable ROM
550 POP AF
560 OUT (19H),A
570 POP AF
580 OUT (17H),A
590 EI
600 RET
